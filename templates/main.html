<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>SacState's Predictive Policing</title>
<!--

Tooplate 2095 Level

https://www.tooplate.com/view/2095-level
href="{{ url_for('static', filename='css/style.css') }}
-->
    <!-- load stylesheets -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,600,700">  <!-- Google web font "Open Sans" -->
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='font-awesome-4.7.0/css/font-awesome.min.css') }}">                <!-- Font Awesome -->
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/bootstrap.min.css') }}">                                      <!-- Bootstrap style -->
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='slick/slick.css') }}"/>
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='slick/slick-theme.css') }}"/>
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/datepicker.css') }}"/>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/tooplate-style.css') }}">                                   

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
        <!--[if lt IE 9]>
        <!--
          <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script> -->
          <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
          <![endif]-->
</head>

    <body>
        <div class="tm-main-content" id="top">
            <div class="tm-top-bar-bg"></div>
            <div class="tm-top-bar" id="tm-top-bar">
                <!-- Top Navbar -->
                <div class="container">
                    <div class="row">
                        
                        <nav class="navbar navbar-expand-lg narbar-light">
                            <a class="navbar-brand mr-auto" href="#">
                                <img src="static/img/logo.png" alt="Site logo">
                                SacState's Predictive Policing
                            </a>
                            <button type="button" id="nav-toggle" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#mainNav" aria-expanded="false" aria-label="Toggle navigation">
                                <span class="navbar-toggler-icon"></span>
                            </button>
                            <div id="mainNav" class="collapse navbar-collapse tm-bg-white">
                                <ul class="navbar-nav ml-auto">
                                  <li class="nav-item">
                                    <a class="nav-link" href="#top">Predictions<span class="sr-only">(current)</span></a>
                                  </li>
                                  <li class="nav-item">
                                    <a class="nav-link" href="#tm-section-2">Log Crime</a>
                                  </li>
                                  <li class="nav-item">
                                    <a class="nav-link" href="#tm-section-5">Data Distribution</a>
                                  </li>
                                  <li class="nav-item">
                                    <a class="nav-link" href="#tm-section-7">Portfolio</a>
                                  </li>
                                </ul>
                            </div>                            
                        </nav>            
                    </div>
                </div>
                <div class="tm-bg-primary tm-sidebar-pad">
                    <marquee behavior="scroll" direction="left"><h5 class="tm-color-white tm-sidebar-title">Bulletin Board: Today's prediction for {{todays_date}} - '{{todays_crime}}' predicted to occur at '{{todays_location}}'.</h5></marquee>
                </div>
            </div>
              
             <div class="tm-section tm-bg-img" id="tm-section-1">
                <div class="tm-bg-white ie-container-width-fix-2">
                    
                    <div class="container ie-h-align-center-fix">
                        <div class="row">
                            <div class="col-xs-12 ml-auto mr-auto ie-container-width-fix">
                                <form action="{{ url_for('hotspots')}}" method="post" class="tm-search-form tm-section-pad-2">
                                    <div class="form-row tm-search-form-row">
                                        <div class="form-group tm-form-element tm-form-element-100">
                                            <i class="fa fa-map-marker fa-2x tm-form-element-icon"></i>
                                            <select name="location" class="form-control tm-select" id="adult" required>
                                                <option value="">Location</option>
                                                <option value="upper east side lofts">Upper Eastside Lofts</option><option value="parking structure 1">Parking Structure 1</option>
                                                <option value="rec and wellness center">The Well</option><option value="library">Library</option>
                                                <option value="parking structure 2">Parking Structure 2</option><option value="collegetown drive">Collegetown Drive</option>
                                                <option value="riverside hall">Riverside Hall</option><option value="hornet bookstore">Hornet Bookstore</option>
                                                <option value="parking structure 3">Parking Structure 3</option><option value="amador hall">Amador Hall</option>
                                                <option value="sierra hall">Sierra Hall</option><option value="yosemite hall">Yosemite Hall</option>
                                                <option value="sequoia hall">Sequoia Hall</option><option value="dining commons">Dining Commons</option>
                                                <option value="lot 4">Lot 4</option><option value="american river courtyard">American River Courtyard</option>
                                                <option value="lot 11">Lot 11</option><option value="lot 2">Lot 2</option>
                                                <option value="folsom hall">Folsom Hall</option><option value="academic information resource center">Academic Information Resource Center</option>
                                                <option value="eureka hall">Eureka Hall</option><option value="mendocino hall">Mendocino Hall</option>
                                                <option value="folsom blvd">Folsom Blvd</option><option value="lot 8">Lot 8</option>
                                                <option value="shasta hall">Shasta Hall</option><option value="residence hall parking">Residence Hall Parking</option>
                                                <option value="draper hall">Draper Hall</option><option value="desmond hall">Desmond Hall</option>
                                                <option value="university union">University Union</option><option value="jenkins hall">Jenkins Hall</option>
                                                <option value="lot 7">Lot 7</option><option value="brighton hall">Brighton hall</option>
                                                <option value="lot 1">Lot 1</option><option value="del norte hall">Del Norte Hall</option>
                                                <option value="sutter hall">Sutter Hall</option><option value="bike compound #1">Bike Compound #1</option>
                                                <option value="lot 10">Lot 10</option><option value="non campus locations">Non Campus Locations</option>
                                                <option value="stadium">Stadium</option><option value="solano hall">Solano Hall</option>
                                                <option value="state university drive">State University Drive</option><option value="river front center">River Front Center</option>
                                                <option value="bike compound #3">Bike Compound #3</option><option value="parking structure 5">Parking Structure 5</option>
                                            </select>
                                        </div>
                                        <div class="form-group tm-form-element tm-form-element-50">
                                            <i class="fa fa-calendar fa-2x tm-form-element-icon"></i>
                                            <input name="future-date" type="date" id="date-widget" class="form-control" placeholder="Date" required>
                                        </div>
                                        <div class="form-group tm-form-element tm-form-element-2">                                            
                                            <select name="time-hour" class="form-control tm-select" id="time-hour" required>
                                                <option value="">Hour</option>
                                                <option value="1">1</option>
                                                <option value="2">2</option>
                                                <option value="3">3</option>
                                                <option value="4">4</option>
                                                <option value="5">5</option>
                                                <option value="6">6</option>
                                                <option value="7">7</option><option value="10">8</option>
                                                <option value="8">9</option><option value="10">10</option>
                                                <option value="9">11</option><option value="10">12</option>
                                                <option value="10">13</option><option value="10">14</option>
                                                <option value="10">15</option><option value="10">16</option>
                                                <option value="10">17</option><option value="10">18</option>
                                                <option value="10">19</option><option value="10">20</option>
                                                <option value="10">21</option><option value="10">22</option>
                                                <option value="10">23</option><option value="10">24</option>
                                            </select>
                                            
                                            <i class="fa fa-2x fa-clock-o tm-form-element-icon"></i>
                                        </div>
                                    </div>
                                    <div class="form-row tm-search-form-row">
                                        <div class="form-group tm-form-element tm-form-element-2">
                                            <button type="submit" class="btn btn-primary tm-btn-search">Get Started</button>
                                        </div>
                                      </div>
                                </form>
                            </div>                        
                        </div>      
                    </div>
                </div>                  
            </div>
            
            
            <div class="tm-article-pad">
                            <header><h3 class="text-uppercase tm-article-title-2" style="color: black;">{{prediction_crime}} predicted to occur at {{given_location}} on {{given_date}} at {{given_time}} hours</h3></header>
                </div>
           <div class="tm-section tm-section-pad tm-bg-img tm-position-relative" id="tm-section-6">
                <div class="container ie-h-align-center-fix">
                    <div class="row">
                        <div class="col-xs-12 col-sm-12 col-md-6 col-lg-6 col-xl-7">
                           <div id="google-map"></div>
                        </div>
                        
                        <div class="col-xs-12 col-sm-12 col-md-6 col-lg-6 col-xl-5 mt-3 mt-md-0">
                            <div class="tm-bg-white tm-p-4">
                                <div class="tm-bg-white">
                                    <div class="tm-bg-primary tm-sidebar-pad">
                                        <h5 class="tm-color-white tm-sidebar-title">Spot Crimes</h5>
                                        <p class="tm-color-white tm-margin-b-0 tm-font-light">Predictive crimes for {{given_date}} at {{given_time}} hours</p>
                                    </div>
                                
                                    <div class="tm-sidebar-pad-2">
                                        {% for key in prediction_top_crime_types %}
                                        <a class="media tm-media tm-recommended-item">
                                            <img src="static/img/tn-img-{{key}}.png" alt="Image" width="100" height="80" onerror=this.src="static/img/tn-img-alternative.png">
                                            <div class="media-body tm-media-body tm-bg-gray">
                                                <h4 class="text-uppercase tm-font-semibold tm-sidebar-item-title" id="spot-crime-selected" onclick=someFunction({{"".join(key.split()) | tojson}})>{{key}}</h4>
                                            </div>                                        
                                        </a>
                                    {% endfor %}
                                    <!--{{top_crime_types_with_probs}}-->   
                                    </div> 
                                </div> 
                            </div>     
                        </div>
                    </div>
                        
                </div>
            </div>
            
            
            <div class="tm-section tm-section-pad tm-bg-gray">
                <a class="text-uppercase btn-primary tm-btn-primary" style="margin-top:10px; width: 50%;" id="heat-map-request" onclick=plotHeatMap()>Campus HeatMap</a>
                <div id="google-heat-map" style="width:100%; height:500px; margin-left=80px;"></div>
                
                <!--
                <a href="{{ url_for('safeguardlocations')}}" method="post" class="text-uppercase btn-primary tm-btn-primary" style="margin-top:10px; width: 50%;">Safeguard Locations</a>
                <div class="container">
                    <div class="row">
                
                        <div class="table-responsive">
                            <table class="table">
                                <tbody>
                                    {% for key in prediction_top_crime_types %}
                                    <tr class="accordion-toggle collapsed" id="accordion1" data-toggle="collapse" data-parent="#accordion1" href="#collapse-{{loop.index}}">
                                        <td class="expand-button"></td>
                                        <td><a style="font-weight: bold; text-transform: UPPERCASE;">{{key}}</a></td>
                                    </tr>
                                    <tr class="hide-table-padding">
                                        <td></td>
                                            <td colspan="3">
                                                <div id="collapse-{{loop.index}}" class="collapse in p-3">
                                                    <div class="row">
                                                         <div class="col-6">Jenkins Hall</div>
                                                         <div class="col-6">Desmond Hall</div>
                                                         <div class="col-6">Draper Hall</div>
                                                         <div class="col-6">Shasta Hall</div>
                                                         <div class="col-6">Mendocino Hall</div>
                                                         <div class="col-6">Eureka Hall</div>
                                                         <div class="col-6">Academic Information Resource Center</div>
                                                     </div>
                                                </div>
                                            </td>
                                    </tr>
                                    {% endfor %}
                                </tbody>
                            </table>
                        </div>
                    -->
                    
                    </div>
                </div>
            </div>
            
            <div class="tm-section tm-section-pad tm-bg-img tm-position-relative" id="tm-section-2">
                <div class="container ie-h-align-center-fix">
                    <div class="row">
                        <div class="col-xs-12 col-sm-12 col-md-6 col-lg-6 col-xl-7">
                            <div class="tm-bg-white tm-p-4" style="height:500px; overflow:scroll; overflow-x:hidden;">
                                <a class="text-uppercase btn-primary tm-btn-primary" style="color:white;">Help us improve our prediction system</a>
                                <form action="{{ url_for('reportcrime')}}" method="post" class="contact-form">
                                    <div class="form-group">
                                        <!-- <input type="text" id="report_address" name="report_address" class="form-control" placeholder="Address"  required/> -->
                                        <select name="report_address" class="form-control tm-select" id="report_address" required onchange = "otherAddressTextBox(this.value)">
                                                <option value="">Location</option>
                                                <option value="upper east side lofts">Upper Eastside Lofts</option><option value="parking structure 1">Parking Structure 1</option>
                                                <option value="rec and wellness center">The Well</option><option value="library">Library</option>
                                                <option value="parking structure 2">Parking Structure 2</option><option value="collegetown drive">Collegetown Drive</option>
                                                <option value="riverside hall">Riverside Hall</option><option value="hornet bookstore">Hornet Bookstore</option>
                                                <option value="parking structure 3">Parking Structure 3</option><option value="amador hall">Amador Hall</option>
                                                <option value="sierra hall">Sierra Hall</option><option value="yosemite hall">Yosemite Hall</option>
                                                <option value="sequoia hall">Sequoia Hall</option><option value="dining commons">Dining Commons</option>
                                                <option value="lot 4">Lot 4</option><option value="american river courtyard">American River Courtyard</option>
                                                <option value="lot 11">Lot 11</option><option value="lot 2">Lot 2</option>
                                                <option value="folsom hall">Folsom Hall</option><option value="academic information resource center">Academic Information Resource Center</option>
                                                <option value="eureka hall">Eureka Hall</option><option value="mendocino hall">Mendocino Hall</option>
                                                <option value="folsom blvd">Folsom Blvd</option><option value="lot 8">Lot 8</option>
                                                <option value="shasta hall">Shasta Hall</option><option value="residence hall parking">Residence Hall Parking</option>
                                                <option value="draper hall">Draper Hall</option><option value="desmond hall">Desmond Hall</option>
                                                <option value="university union">University Union</option><option value="jenkins hall">Jenkins Hall</option>
                                                <option value="lot 7">Lot 7</option><option value="brighton hall">Brighton hall</option>
                                                <option value="lot 1">Lot 1</option><option value="del norte hall">Del Norte Hall</option>
                                                <option value="sutter hall">Sutter Hall</option><option value="bike compound #1">Bike Compound #1</option>
                                                <option value="lot 10">Lot 10</option><option value="non campus locations">Non Campus Locations</option>
                                                <option value="stadium">Stadium</option><option value="solano hall">Solano Hall</option>
                                                <option value="state university drive">State University Drive</option><option value="river front center">River Front Center</option>
                                                <option value="bike compound #3">Bike Compound #3</option><option value="parking structure 5">Parking Structure 5</option>
                                                <option value="Other">Other</option>
                                            </select>
                                    </div>
                                    <div class="form-group">
                                        <input type="text" id="other_report_address" name="report_address" class="form-control" placeholder="If 'Other' Location specify" style='display:none;'/>
                                    </div>
                                    <div class="form-group">
                                        <!-- <input type="text" id="report_crime_type" name="report_crime_type" class="form-control" placeholder="Crime Type"  required/> -->
                                        <select name="report_crime_type" class="form-control tm-select" id="report_crime_type" required onchange = "otherCrimeTypeTextBox(this.value)">
                                                <option value="">Crime Type</option>
                                                <option value="disturbing the peace">Disturbing the Peace</option>
                                                <option value="theft">Theft</option>
                                                <option value="hit and run">Hit and Run</option>
                                                <option value="other agency misdemeanor warrant">Other Agency Misdemeanor Warrant</option>
                                                <option value="driving under influence of drugs/alcohol">Driving Under Influence of Drugs/Alcohol</option>
                                                <option value="vandalism">Vandalism</option>
                                                <option value="assault/sexual/battery report">Assault/Sexual/Battery Report</option>
                                                <option value="possession of controlled substance/marijuana or public drunkenness">Possession of Controlled Substance/Marijuana or Public Drunkenness</option>
                                                <option value="burglary">Burglary</option>
                                                <option value="motor vehicle theft/report of lost or stolen license plate">Motor Vehicle Theft/Report of Lost or Stolen License Plate</option>
                                                <option value="Other">Other</option>
                                            </select>
                                    </div>
                                    <div class="form-group">
                                        <input type="text" id="other_report_crime_type" name="report_crime_type" class="form-control" placeholder="If 'Other' Crime Type specify" style='display:none;'/>
                                    </div>
                                    <div class="form-group">
                                        <input name="report_date" type="date" id="date-widget" class="form-control" placeholder="Date" required>
                                    </div>
                                    <div class="form-group">
                                        <input type="text" id="report_disposition" name="report_disposition" class="form-control" placeholder="Disposition"  required/>
                                    </div>
                                    <div class="form-group">
                                        <select name="report_part_day" class="form-control tm-select" required>
                                                <option value="">Part of the Day</option>
                                                <option value="morning">Morning</option>
                                                <option value="afternoon">Afternoon</option>
                                                <option value="evening">Evening</option>
                                                <option value="night">Night</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <select name="report_hour" class="form-control tm-select" id="adult" required>
                                                <option value="">Hour</option>
                                                <option value="1">1</option>
                                                <option value="2">2</option>
                                                <option value="3">3</option>
                                                <option value="4">4</option>
                                                <option value="5">5</option>
                                                <option value="6">6</option>
                                                <option value="7">7</option><option value="10">8</option>
                                                <option value="8">9</option><option value="10">10</option>
                                                <option value="9">11</option><option value="10">12</option>
                                                <option value="10">13</option><option value="10">14</option>
                                                <option value="10">15</option><option value="10">16</option>
                                                <option value="10">17</option><option value="10">18</option>
                                                <option value="10">19</option><option value="10">20</option>
                                                <option value="10">21</option><option value="10">22</option>
                                                <option value="10">23</option><option value="10">24</option>
                                            </select>
                                    </div>
                                    <div class="form-group">
                                        <textarea id="report_public_info" name="report_public_info" class="form-control" rows="4" placeholder="Public Information" required></textarea>
                                    </div>
                                    <button type="submit" class="btn btn-primary tm-btn-primary">Submit</button>
                                </form>
                            </div>                            
                        </div>
                        <div class="col-xs-12 col-sm-12 col-md-6 col-lg-6 col-xl-5 mt-3 mt-md-0">
                            <br></br>
                            <a>Address: This field refers to address where the crime incident occurred.</a>
                            <br></br><br></br>
                            <a>Disposition: Describe the action taken to address the complaint.</a>
                            <br></br><br></br>
                            <a>Public Information: This information will be disclosed to the public on request.</a>
                            <br></br><br></br>
                            <a>Part of the Day: Indicate whether it was morning, afternoon or evening when the crime occurred.</a>
                        </div>
                    </div>        
                </div>
            </div>  
            
                          
           <div class="tm-section tm-section-pad" id="tm-section-5">                                                        
                <div id="carouselExampleIndicators" class="carousel slide" data-ride="carousel">
    <ol class="carousel-indicators">
        <li data-target="#carouselExampleIndicators" data-slide-to="0" class="active"></li>
        <li data-target="#carouselExampleIndicators" data-slide-to="1"></li>
        <li data-target="#carouselExampleIndicators" data-slide-to="2"></li>
    </ol>
    <div class="carousel-inner" style="width: 80%; height: auto; align: center;">
        <div class="carousel-item active">
            <img class="d-block w-100" src="static/img/graph-img-2.png" alt="First slide">
            <div class="carousel-caption d-none d-md-block">
                <h5></h5>
                <p></p>
            </div>
        </div>
        <!--
        <div class="carousel-item">
            <img class="d-block w-100" src="static/img/graph-img-4.png" alt="Second slide">
        </div>
        -->
        <div class="carousel-item">
            <img class="d-block w-100" src="static/img/graph-img-3.png" alt="Second slide">
        </div>
        <!--
        <div class="carousel-item">
            <img class="d-block w-100" src="static/img/graph-img-1.png" alt="Third slide">
        </div>
        -->
    </div>
    <a class="carousel-control-prev" href="#carouselExampleIndicators" role="button" data-slide="prev">
        <span class="carousel-control-prev-icon" aria-hidden="true" style="outline: black;"></span>
        <span class="sr-only">Previous</span>
    </a>
    <a class="carousel-control-next" href="#carouselExampleIndicators" role="button" data-slide="next">
        <span class="carousel-control-next-icon" aria-hidden="true" style="outline: black;"></span>
        <span class="sr-only">Next</span>
    </a>
</div>
                
            </div>
                    
            <div class="tm-section tm-section-pad tm-bg-img tm-position-relative" id="tm-section-7">
                <div class="tm-section tm-position-relative">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" preserveAspectRatio="none" class="tm-section-down-arrow">
                    <polygon fill="#ee5057" points="0,0  100,0  50,60"></polygon>                   
                </svg> 
                <div class="container tm-pt-5 tm-pb-4">
                    <div class="row text-center">
                        <article class="col-sm-12 col-md-4 col-lg-4 col-xl-4 tm-article">                            
                            <i class="fa tm-fa-6x fa-star tm-color-primary tm-margin-b-20"></i>
                            <h3 class="tm-color-primary tm-article-title-1">Safety strategy for an upcoming event</h3>
                            <p>Get the accurate safety strategy for an upcoming event, without overlooking other locations.</p>
                            <a href="#" class="text-uppercase tm-color-primary tm-font-semibold">Continue reading...</a>
                        </article>
                        <article class="col-sm-12 col-md-4 col-lg-4 col-xl-4 tm-article">                            
                            <i class="fa tm-fa-6x fa-check-circle tm-color-primary tm-margin-b-20"></i>
                            <h3 class="tm-color-primary tm-article-title-1">Safeguard locations</h3>
                            <p>Get complete information of safeguarding locations, based on our predictive model.</p>
                            <a href="#" class="text-uppercase tm-color-primary tm-font-semibold">Continue reading...</a>                            
                        </article>
                        <article class="col-sm-12 col-md-4 col-lg-4 col-xl-4 tm-article">                           
                            <i class="fa tm-fa-6x fa-life-saver tm-color-primary tm-margin-b-20"></i>
                            <h3 class="tm-color-primary tm-article-title-1">Contact us if you have any question</h3>
                            <p>If you have any questions about the product contact us here.</p>
                            <a href="#" class="text-uppercase tm-color-primary tm-font-semibold">More Info...</a>                           
                        </article>
                    </div>        
                </div>
            </div>
            </div>
            
            <footer class="tm-bg-dark-blue">
                <div class="container">
                    <div class="row">
                        <p class="col-sm-12 text-center tm-font-light tm-color-white p-4 tm-margin-b-0">
                        <span class="tm-current-year">2020</span> California State University - Sacramento      
                    </div>
                </div>                
            </footer>
        </div>
        
        <!-- load JS files -->
        <script src="static/js/jquery-1.11.3.min.js"></script>             <!-- jQuery (https://jquery.com/download/) -->
        <script src="static/js/popper.min.js"></script>                    <!-- https://popper.js.org/ -->       
        <script src="static/js/bootstrap.min.js"></script>                 <!-- https://getbootstrap.com/ -->
        <script src="static/js/datepicker.min.js"></script>                <!-- https://github.com/qodesmith/datepicker -->
        <script src="static/js/jquery.singlePageNav.min.js"></script>      <!-- Single Page Nav (https://github.com/ChrisWojcik/single-page-nav) -->
        <script src="static/slick/slick.min.js"></script>                  <!-- http://kenwheeler.github.io/slick/ -->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-ui-map/3.0-rc1/jquery.ui.map.js"></script>
        <script>
        
        function otherCrimeTypeTextBox(val) {
            var otherAddr = document.getElementById('other_report_crime_type');
            if (val == 'Other')
                otherAddr.style.display = 'block';
            else
                otherAddr.style.display = 'none';
        }
        
        function otherAddressTextBox(val) {
            var otherCrime = document.getElementById('other_report_address');
            if (val == 'Other')
                otherCrime.style.display = 'block';
            else
                otherCrime.style.display = 'none';
        }
        
        var loc_coordinates_dict = {
                "upper east side lofts": [38.553732, -121.428936],
                "parking structure 1": [38.559829, -121.426964],
                "rec and wellness center": [38.564380, -121.425274],
                "library": [38.559685, -121.423653],
                "collegetown drive": [38.554387, -121.419556],
                "parking structure 2": [38.559218, -121.420104],
                "riverside hall": [38.561145, -121.422410],
                "hornet bookstore": [38.560135, -121.420718],
                "amador hall": [38.559124, -121.424823],
                "parking structure 3": [38.557450, -121.421186],
                "sierra hall": [38.567245, -121.426406],
                "yosemite hall": [38.562894, -121.427245],
                "dining commons": [38.567521, -121.425854],
                "sequoia hall": [38.562112, -121.422627],
                "american river courtyard": [38.566177, -121.425800],
                "lot 2": [38.565746, -121.424560],
                "lot 11": [38.567267, -121.428174],
                "folsom hall": [38.551564, -121.414236],
                "academic information resource center": [38.559042, -121.423010],
                "mendocino hall": [38.562851, -121.423579],
                "eureka hall": [38.561154, -121.425116],
                "shasta hall": [38.564610, -121.424111],
                "draper hall": [38.567394, -121.424891],
                "desmond hall": [38.566519, -121.424453],
                "jenkins hall": [38.566850, -121.424691],
                "university union": [38.559620, -121.422536],
                "lot 7": [38.559620, -121.422536],
                "brighton hall": [38.561390, -121.424099],
                "del norte hall": [38.563312, -121.423303],
                "sutter hall": [38.566645, -121.427224],
                "bike compound #1": [38.561500, -121.421998],
                "lot 10": [38.561500, -121.421998],
                "stadium": [38.555789, -121.422942],
                "solano hall": [38.561905, -121.426254],
                "river front center": [38.563767, -121.423903],
                "state university drive": [38.561243, -121.421440]    
            };
            
        /*heatmap
        */
        function plotHeatMap() {
        var heatmapData = [
  new google.maps.LatLng(38.553732, -121.428936),
  new google.maps.LatLng(38.559829, -121.426964),
  new google.maps.LatLng(38.564380, -121.425274),
  new google.maps.LatLng(38.559685, -121.423653),
  new google.maps.LatLng(38.554387, -121.419556),
  new google.maps.LatLng(38.559218, -121.420104),
  new google.maps.LatLng(38.561145, -121.422410),
  new google.maps.LatLng(38.560135, -121.420718),
  new google.maps.LatLng(38.559124, -121.424823),
  new google.maps.LatLng(38.557450, -121.421186),
  new google.maps.LatLng(38.567245, -121.426406),
  new google.maps.LatLng(38.567521, -121.425854),
  new google.maps.LatLng(38.562112, -121.422627),
  new google.maps.LatLng(38.566177, -121.425800)
];
             $.ajax({
              url: '/get_session',
              type: 'GET',
              dataType: 'json',
              success: function(result){
                  $.each(result, function(loc, crime) {
                      var newMap = new google.maps.Map(document.getElementById('google-heat-map'), {
                      center: new google.maps.LatLng(38.562984, -121.426384),
                      zoom: 15,
                    });
                    var heatmap = new google.maps.visualization.HeatmapLayer({
                      data: heatmapData
                    });
                    heatmap.setMap(newMap);
                });
              },
              error: function(result){
                console.log("get_session error");
              }
            });
        }
        
        /* hotspot map update
        */
        function someFunction(data) {
            // step1: based on current crime, fetch locations
            var marker_locations = []
            $.ajax({
              url: '/get_session',
              type: 'GET',
              dataType: 'json',
              success: function(result){
                  /*
                  map.setCenter({
            		lat : 38.562984,
            		lng : -121.426384
                  });
                  */
                
                // get all existing markers
                var existingMarkers = $('#google-map').gmap('get', 'markers');
                while(existingMarkers.length) {
                    var oldMarker = existingMarkers.pop();
                    oldMarker.setMap(null);
                }
                
                $.each(result, function(loc, crime) {
                    var crim = crime.split(/\s/).join('');
                    if (crim === data)
                        marker_locations.push(loc);
                });
                
                var newLatLngs = {}
                //get lat, lngs for predicted markers_locations
                $.each(marker_locations, function(index, mark_loc) {
                    if (mark_loc in loc_coordinates_dict)
                        newLatLngs[mark_loc] = loc_coordinates_dict[mark_loc]
                });
                
                /*
                option1: map.setCenter({lat:38.562984, lng:-121.426384})
                option2: gMap = new google.maps.Map(document.getElementById('google-map')); 
                         gMap.setCenter(new google.maps.LatLng(38.561422, -121.424358));
                option3: var newgmapMap = new google.maps.Map(document.getElementById('google-heat-map'), {
                          center: new google.maps.LatLng(38.562984, -121.426384)
                        });
                option4: window.setTimeout(function() {map.setCenter({lat:38.562984, lng:-121.426384});},3000);
                */
                
                var i;
                $.each(newLatLngs, function(title_info, ll) {
                    $('#google-map').gmap('addMarker', {id: i, 'position': new google.maps.LatLng(ll[0], ll[1]), 'title':title_info});
                });
                map.setCenter({lat:38.562984, lng:-121.426384});
             },
              error: function(result){
                console.log("get_session error");
              }
            });
        }
        
        /* Date add from present date
        -------------------------------------------*/
        $(function(){
            var today_date = new Date();
            var month = today_date.getMonth() + 1;
            var day = today_date.getDate();
            var year = today_date.getFullYear();
            
            if(month < 10) month = '0' + month.toString();
            if(day < 10) day = '0' + day.toString();

            var start_date = year + '-' + month + '-' + day;
            $('#date-widget').attr('min', start_date);
        });
        
            /* Google map
            ------------------------------------------------*/
            var map = '';
            var heatMap = '';
            var center;

            function initialize() {
                var mapOptions = {
                    zoom: 13,
                    center: new google.maps.LatLng(38.562984, -121.426384),
                    scrollwheel: false
                };

                map = new google.maps.Map(document.getElementById('google-map'),  mapOptions);
                heatMap = new google.maps.Map(document.getElementById('google-heat-map'),  mapOptions);

                google.maps.event.addDomListener(map, 'idle', function() {
                  calculateCenter();
              });

                google.maps.event.addDomListener(window, 'resize', function() {
                  map.setCenter(center);
              });
            }

            function calculateCenter() {
                $('#map_canvas').gmap('addMarker', {id: 1, 'position': new google.maps.LatLng(38.562984, -121.426384), title: "CSUS"});
                center = map.getCenter();
            }

            function loadGoogleMap(){
                var script = document.createElement('script');
                script.type = 'text/javascript';
                script.defer = true;
                script.src = 'https://maps.googleapis.com/maps/api/js?key={INSERT_API_KEY_HERE}&libraries=visualization&callback=initialize';
                document.body.appendChild(script);
            }
            

            function setCarousel() {
                if ($('.tm-article-carousel').hasClass('slick-initialized')) {
                    $('.tm-article-carousel').slick('destroy');
                } 

                if($(window).width() < 438){
                    // Slick carousel
                    $('.tm-article-carousel').slick({
                        infinite: false,
                        dots: true,
                        slidesToShow: 1,
                        slidesToScroll: 1
                    });
                }
                else {
                 $('.tm-article-carousel').slick({
                        infinite: false,
                        dots: true,
                        slidesToShow: 2,
                        slidesToScroll: 1
                    });   
                }
            }

            function setPageNav(){
                if($(window).width() > 991) {
                    $('#tm-top-bar').singlePageNav({
                        currentClass:'active',
                        offset: 79
                    });   
                }
                else {
                    $('#tm-top-bar').singlePageNav({
                        currentClass:'active',
                        offset: 65
                    });   
                }
            }

            function togglePlayPause() {
                vid = $('.tmVideo').get(0);

                if(vid.paused) {
                    vid.play();
                    $('.tm-btn-play').hide();
                    $('.tm-btn-pause').show();
                }
                else {
                    vid.pause();
                    $('.tm-btn-play').show();
                    $('.tm-btn-pause').hide();   
                }  
            }
       
            $(document).ready(function(){

                $(window).on("scroll", function() {
                    if($(window).scrollTop() > 100) {
                        $(".tm-top-bar").addClass("active");
                    } else {
                        //remove the background property so it comes transparent again (defined in your css)
                       $(".tm-top-bar").removeClass("active");
                    }
                });      

                // Google Map
                loadGoogleMap();  

                // Date Picker
                const pickerCheckIn = datepicker('#inputCheckIn');
                const pickerCheckOut = datepicker('#inputCheckOut');
                
                // Slick carousel
                setCarousel();
                setPageNav();

                $(window).resize(function() {
                  setCarousel();
                  setPageNav();
                });

                // Close navbar after clicked
                $('.nav-link').click(function(){
                    $('#mainNav').removeClass('show');
                });

                // Control video
                $('.tm-btn-play').click(function() {
                    togglePlayPause();                                      
                });

                $('.tm-btn-pause').click(function() {
                    togglePlayPause();                                      
                });

                // Update the current year in copyright
                $('.tm-current-year').text(new Date().getFullYear());                           
            });

        </script>             

</body>
</html>